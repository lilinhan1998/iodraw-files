{"type":"wb","version":2,"source":"https://www.iodraw.com","elements":[{"type":"rectangle","version":195,"versionNonce":1185962194,"isDeleted":false,"id":"p6I1dKxZc41NF16kjM-CR","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":646,"y":133,"strokeColor":"#000000","backgroundColor":"transparent","width":391,"height":100,"seed":1778054514,"groupIds":[],"strokeSharpness":"sharp","boundElements":[{"type":"text","id":"-6xBTOsmF43_yNgONn7ty"}],"updated":1746607444877,"link":null},{"type":"text","version":146,"versionNonce":2109461838,"isDeleted":false,"id":"-6xBTOsmF43_yNgONn7ty","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":651,"y":138,"strokeColor":"#000000","backgroundColor":"transparent","width":381,"height":90,"seed":1456679790,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1746607444877,"link":null,"fontSize":20,"fontFamily":1,"text":"bt_navigator.cpp\nBtNavigator类，继承了生命周期节点，\n用来加载行为树导航服务器","baseline":80,"textAlign":"center","verticalAlign":"middle","containerId":"p6I1dKxZc41NF16kjM-CR","originalText":"bt_navigator.cpp\nBtNavigator类，继承了生命周期节点，用来加载行为树导航服务器"},{"type":"rectangle","version":191,"versionNonce":71846418,"isDeleted":false,"id":"YEvd2qFJJzELeXmrjEIcM","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":872,"y":311,"strokeColor":"#000000","backgroundColor":"transparent","width":420,"height":160,"seed":1627521006,"groupIds":[],"strokeSharpness":"sharp","boundElements":[{"type":"text","id":"SM8pKQok9O42vIkjwZZ_q"},{"id":"r8kZs1dzNBJZNKA5dMFC1","type":"arrow"},{"id":"6cHA1sRoRDoEY1Bz77h5Y","type":"arrow"},{"id":"7z-xxbGT_aC3-5Vz6ovfM","type":"arrow"}],"updated":1746607495835,"link":null},{"type":"text","version":201,"versionNonce":846199694,"isDeleted":false,"id":"SM8pKQok9O42vIkjwZZ_q","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":877,"y":331,"strokeColor":"#000000","backgroundColor":"transparent","width":410,"height":120,"seed":1190579250,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1746607444877,"link":null,"fontSize":20,"fontFamily":1,"text":"navigate_to_pose.cpp\nNavigatorToPoseNavigator类\n派生类实现navigate_to_pose客户端，并订\n阅目标点（回调函数中客户端直接发送目标）","baseline":110,"textAlign":"center","verticalAlign":"middle","containerId":"YEvd2qFJJzELeXmrjEIcM","originalText":"navigate_to_pose.cpp\nNavigatorToPoseNavigator类\n派生类实现navigate_to_pose客户端，并订阅目标点（回调函数中客户端直接发送目标）"},{"type":"rectangle","version":94,"versionNonce":1766444114,"isDeleted":false,"id":"TTlj6wFpPfqYnHa-54nyO","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":343,"y":324,"strokeColor":"#000000","backgroundColor":"transparent","width":390,"height":130,"seed":1956593842,"groupIds":[],"strokeSharpness":"sharp","boundElements":[{"type":"text","id":"JX0WBLNsg75m39Vjig0S8"},{"id":"r8kZs1dzNBJZNKA5dMFC1","type":"arrow"},{"id":"6cHA1sRoRDoEY1Bz77h5Y","type":"arrow"},{"id":"27ey-GzK0x0hS9NXtRdVr","type":"arrow"}],"updated":1746607444877,"link":null},{"type":"text","version":65,"versionNonce":38099406,"isDeleted":false,"id":"JX0WBLNsg75m39Vjig0S8","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":348,"y":329,"strokeColor":"#000000","backgroundColor":"transparent","width":380,"height":120,"seed":1765106098,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1746607444877,"link":null,"fontSize":20,"fontFamily":1,"text":"navigator.hpp\nNavigator类，实例化一个行为树action服\n务器\nBtActionServer","baseline":110,"textAlign":"center","verticalAlign":"middle","containerId":"TTlj6wFpPfqYnHa-54nyO","originalText":"navigator.hpp\nNavigator类，实例化一个行为树action服务器\nBtActionServer"},{"type":"arrow","version":261,"versionNonce":850424338,"isDeleted":false,"id":"6cHA1sRoRDoEY1Bz77h5Y","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":867,"y":392.0901314215884,"strokeColor":"#000000","backgroundColor":"transparent","width":129,"height":3.552468949756701,"seed":1568222318,"groupIds":[],"strokeSharpness":"round","boundElements":[],"updated":1746607444877,"link":null,"startBinding":{"elementId":"YEvd2qFJJzELeXmrjEIcM","focus":0.056312382992136416,"gap":5},"endBinding":{"elementId":"TTlj6wFpPfqYnHa-54nyO","focus":0.2819683239163023,"gap":5},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[-129,3.552468949756701]]},{"type":"rectangle","version":108,"versionNonce":1683288078,"isDeleted":false,"id":"srzPkGJwmXR2A9qq2P01Y","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":744,"y":326,"strokeColor":"#000000","backgroundColor":"transparent","width":113,"height":43,"seed":591722542,"groupIds":[],"strokeSharpness":"sharp","boundElements":[{"type":"text","id":"CavcBu6aToCWcL6oLiIA4"}],"updated":1746607444877,"link":null},{"type":"text","version":73,"versionNonce":1807507410,"isDeleted":false,"id":"CavcBu6aToCWcL6oLiIA4","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":749,"y":332.5,"strokeColor":"#000000","backgroundColor":"transparent","width":103,"height":30,"seed":893149614,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1746607444877,"link":null,"fontSize":20,"fontFamily":1,"text":"继承关系","baseline":20,"textAlign":"center","verticalAlign":"middle","containerId":"srzPkGJwmXR2A9qq2P01Y","originalText":"继承关系"},{"type":"rectangle","version":174,"versionNonce":77053518,"isDeleted":false,"id":"aW47j8efQW4Ghx1tjj3jI","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":338,"y":527,"strokeColor":"#000000","backgroundColor":"transparent","width":488,"height":190,"seed":1544942386,"groupIds":[],"strokeSharpness":"sharp","boundElements":[{"type":"text","id":"sa-g0v980QwmOvJ77LMlN"},{"id":"27ey-GzK0x0hS9NXtRdVr","type":"arrow"},{"id":"3lw90O7h3MYgsNFbwK3GA","type":"arrow"}],"updated":1746607444877,"link":null},{"type":"text","version":215,"versionNonce":8689042,"isDeleted":false,"id":"sa-g0v980QwmOvJ77LMlN","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":343,"y":547,"strokeColor":"#000000","backgroundColor":"transparent","width":478,"height":150,"seed":418879790,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1746607444877,"link":null,"fontSize":20,"fontFamily":1,"text":"bt_action_server_impl.hpp\nBtActionServer类，实现行为树action服务端，使用\nBehaviorTreeEngine加载行为树节点库，创建blackbo\nard，拿到行为树节点后，创建行为树，服务端收到响\n应后开始执行行为树tick函数","baseline":140,"textAlign":"center","verticalAlign":"middle","containerId":"aW47j8efQW4Ghx1tjj3jI","originalText":"bt_action_server_impl.hpp\nBtActionServer类，实现行为树action服务端，使用BehaviorTreeEngine加载行为树节点库，创建blackboard，拿到行为树节点后，创建行为树，服务端收到响应后开始执行行为树tick函数"},{"type":"arrow","version":241,"versionNonce":669435022,"isDeleted":false,"id":"27ey-GzK0x0hS9NXtRdVr","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":3.19699558604402,"x":527.1343172029622,"y":455,"strokeColor":"#000000","backgroundColor":"transparent","width":5.271885949411285,"height":71,"seed":2146506734,"groupIds":[],"strokeSharpness":"round","boundElements":[],"updated":1746607444877,"link":null,"startBinding":null,"endBinding":{"elementId":"TTlj6wFpPfqYnHa-54nyO","focus":0.05288585184442305,"gap":2.2716156962888476},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[5.271885949411285,71]]},{"type":"rectangle","version":79,"versionNonce":1111495506,"isDeleted":false,"id":"nkmJPximmhezywQ-Vo1Zp","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":894,"y":547,"strokeColor":"#000000","backgroundColor":"transparent","width":417,"height":141,"seed":58438450,"groupIds":[],"strokeSharpness":"sharp","boundElements":[{"type":"text","id":"hJEC6_1o6RNtQboikh-9m"},{"id":"3lw90O7h3MYgsNFbwK3GA","type":"arrow"}],"updated":1746607444877,"link":null},{"type":"text","version":57,"versionNonce":268108494,"isDeleted":false,"id":"hJEC6_1o6RNtQboikh-9m","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":899,"y":572.5,"strokeColor":"#000000","backgroundColor":"transparent","width":407,"height":90,"seed":622412846,"groupIds":[],"strokeSharpness":"sharp","boundElements":[],"updated":1746607444877,"link":null,"fontSize":20,"fontFamily":1,"text":"behavior_tree_eigen.cpp\nBehaviorTreeEngine类，除开加载行为树及\n其节点，还实现了整棵树的执行、暂停","baseline":80,"textAlign":"center","verticalAlign":"middle","containerId":"nkmJPximmhezywQ-Vo1Zp","originalText":"behavior_tree_eigen.cpp\nBehaviorTreeEngine类，除开加载行为树及其节点，还实现了整棵树的执行、暂停"},{"type":"arrow","version":236,"versionNonce":1128651026,"isDeleted":false,"id":"3lw90O7h3MYgsNFbwK3GA","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":3.1536879575104884,"x":827,"y":624,"strokeColor":"#000000","backgroundColor":"transparent","width":63,"height":3,"seed":784863090,"groupIds":[],"strokeSharpness":"round","boundElements":[],"updated":1746607444877,"link":null,"startBinding":{"elementId":"nkmJPximmhezywQ-Vo1Zp","focus":0.04452742481247283,"gap":4.092660824402174},"endBinding":{"elementId":"aW47j8efQW4Ghx1tjj3jI","focus":0.10139010763517654,"gap":1},"lastCommittedPoint":null,"startArrowhead":null,"endArrowhead":"arrow","points":[[0,0],[63,-3]]},{"type":"rectangle","version":88,"versionNonce":1601009934,"isDeleted":false,"id":"K6SAeJAaMzA4qxNQrT-j3","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"angle":0,"x":277,"y":91,"strokeColor":"#000000","backgroundColor":"transparent","width":1103,"height":656,"seed":1388185906,"groupIds":[],"strokeSharpness":"sharp","boundElements":[{"id":"L_9QGKvTQ-5g4IBCYOe1E","type":"arrow"}],"updated":1746607444877,"link":null},{"id":"NnaqkL39sred4aBoM450V","type":"rectangle","x":282.16666666666686,"y":769.6388888888888,"width":808,"height":169,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"strokeSharpness":"sharp","seed":964043410,"version":309,"versionNonce":856483538,"isDeleted":false,"boundElements":[{"type":"text","id":"8wZ7SvT7leX9mLhni26qh"},{"id":"y6KMfrIdWZLYCbfAK7EFC","type":"arrow"}],"updated":1746607444877,"link":null},{"id":"8wZ7SvT7leX9mLhni26qh","type":"text","x":287.16666666666686,"y":774.6388888888888,"width":798,"height":150,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"strokeSharpness":"sharp","seed":660032782,"version":401,"versionNonce":2109155150,"isDeleted":false,"boundElements":null,"updated":1746607444877,"link":null,"text":"将导航器和行为树引擎耦合在一起，具体的功能实现在两个模块中有所体现：\n1、导航器中，实现了在on_goal_received_callback_、on_loop_callback_、on_pree\nmpt_callback_、on_completion_callback_回调函数，对不同阶段的导航器的状态做出\n决策；\n2、行为树引擎中，实现了对行为树执行、暂停等功能的封装，供BtActionServer使用。","fontSize":20,"fontFamily":1,"textAlign":"left","verticalAlign":"top","baseline":140,"containerId":"NnaqkL39sred4aBoM450V","originalText":"将导航器和行为树引擎耦合在一起，具体的功能实现在两个模块中有所体现：\n1、导航器中，实现了在on_goal_received_callback_、on_loop_callback_、on_preempt_callback_、on_completion_callback_回调函数，对不同阶段的导航器的状态做出决策；\n2、行为树引擎中，实现了对行为树执行、暂停等功能的封装，供BtActionServer使用。"},{"id":"L_9QGKvTQ-5g4IBCYOe1E","type":"arrow","x":565.5000000000001,"y":712.9722222222223,"width":0,"height":57.777777777777715,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"strokeSharpness":"round","seed":384343374,"version":31,"versionNonce":975977618,"isDeleted":false,"boundElements":null,"updated":1746607444877,"link":null,"points":[[0,0],[0,57.777777777777715]],"lastCommittedPoint":null,"startBinding":null,"endBinding":{"elementId":"K6SAeJAaMzA4qxNQrT-j3","focus":-0.4768812330009064,"gap":23.75},"startArrowhead":null,"endArrowhead":"arrow"},{"id":"bnfsEItuWWriNqulItXZN","type":"rectangle","x":-331.1666666666664,"y":492.9722222222222,"width":557.7777777777777,"height":243.33333333333337,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"strokeSharpness":"sharp","seed":1745086350,"version":75,"versionNonce":2066812302,"isDeleted":false,"boundElements":null,"updated":1746607444877,"link":null},{"id":"EzJ-Zw8gD37UIsPVHNWbh","type":"text","x":-317.8333333333332,"y":503.9722222222222,"width":543,"height":224,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"strokeSharpness":"sharp","seed":534767186,"version":117,"versionNonce":2038006286,"isDeleted":false,"boundElements":[{"id":"UgSY2bpQG9fKOzW6ubCmN","type":"arrow"}],"updated":1746607444877,"link":null,"text":"导航服务器的执行流程\n1、检测目标是否收到；\n2、定义cancel的条件检查函数、循环的回调函数；\n3、将第二步的回调函数传入行为树中，同时行为树开始run，\n得到执行的结果；\n4、停止行为树所有节点的运行；\n5、根据第三步的执行结果，导航服务器执行不同的决策。","fontSize":20,"fontFamily":1,"textAlign":"left","verticalAlign":"top","baseline":216,"containerId":null,"originalText":"导航服务器的执行流程\n1、检测目标是否收到；\n2、定义cancel的条件检查函数、循环的回调函数；\n3、将第二步的回调函数传入行为树中，同时行为树开始run，\n得到执行的结果；\n4、停止行为树所有节点的运行；\n5、根据第三步的执行结果，导航服务器执行不同的决策。"},{"id":"y6KMfrIdWZLYCbfAK7EFC","type":"arrow","x":277.5961207776435,"y":808.4182798462609,"width":75.42945411097662,"height":115.44605762403876,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"strokeSharpness":"round","seed":2031769422,"version":63,"versionNonce":1801064526,"isDeleted":false,"boundElements":null,"updated":1746607444877,"link":null,"points":[[0,0],[-75.42945411097662,-115.44605762403876]],"lastCommittedPoint":null,"startBinding":{"elementId":"NnaqkL39sred4aBoM450V","focus":-0.82467237664425,"gap":4.570545889023435},"endBinding":null,"startArrowhead":null,"endArrowhead":"arrow"},{"id":"zYnZn-1pI3AQNMwJfgWVj","type":"rectangle","x":1468.5555555555552,"y":350.0555555555556,"width":791.5000000000001,"height":262.46098829648895,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":["vY58LCnFxTof_oYG4V9qN"],"strokeSharpness":"sharp","seed":813610258,"version":479,"versionNonce":1547733074,"isDeleted":false,"boundElements":null,"updated":1746607484532,"link":null},{"id":"08lYjvRYutDyx67IjrD6p","type":"text","x":1481.421290275971,"y":366.5236959976882,"width":777.0903771131341,"height":230.55396618985702,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":["vY58LCnFxTof_oYG4V9qN"],"strokeSharpness":"sharp","seed":626093710,"version":542,"versionNonce":1821980626,"isDeleted":false,"boundElements":[{"id":"7z-xxbGT_aC3-5Vz6ovfM","type":"arrow"}],"updated":1746607495835,"link":null,"text":"1、on_goal_received_callback_，接收navigate_to_pose的goal，依靠服务器加\n载行为树，将goal中的目标点写入黑板；\n2、on_loop_callback_，从黑板中获取现在跟踪的路径，计算出剩余的距离和需要\n的时间，通过服务器发布出去；\n3、on_preempt_callback_，通过判断行为树是否发生改变，决定要不要执行抢断当\n前的目标点，行为树发生变化，则不进行抢断；\n4、on_completion_callback_，没有执行有实际影响的功能。","fontSize":20.585175552665802,"fontFamily":1,"textAlign":"left","verticalAlign":"top","baseline":222.55396618985702,"containerId":null,"originalText":"1、on_goal_received_callback_，接收navigate_to_pose的goal，依靠服务器加\n载行为树，将goal中的目标点写入黑板；\n2、on_loop_callback_，从黑板中获取现在跟踪的路径，计算出剩余的距离和需要\n的时间，通过服务器发布出去；\n3、on_preempt_callback_，通过判断行为树是否发生改变，决定要不要执行抢断当\n前的目标点，行为树发生变化，则不进行抢断；\n4、on_completion_callback_，没有执行有实际影响的功能。"},{"id":"7z-xxbGT_aC3-5Vz6ovfM","type":"arrow","x":1314.805555555555,"y":415.8888888888889,"width":143.33333333333326,"height":65,"angle":0,"strokeColor":"#000000","backgroundColor":"transparent","fillStyle":"hachure","strokeWidth":1,"strokeStyle":"solid","roughness":1,"opacity":100,"groupIds":[],"strokeSharpness":"round","seed":1284096590,"version":30,"versionNonce":2059835406,"isDeleted":false,"boundElements":null,"updated":1746607495835,"link":null,"points":[[0,0],[143.33333333333326,65]],"lastCommittedPoint":null,"startBinding":{"elementId":"YEvd2qFJJzELeXmrjEIcM","focus":-0.4604493843544923,"gap":22.805555555554974},"endBinding":{"elementId":"08lYjvRYutDyx67IjrD6p","focus":-0.6376035900996146,"gap":23.2824013870827},"startArrowhead":null,"endArrowhead":"arrow"}],"appState":{"theme":"light","currentChartType":"bar","currentItemBackgroundColor":"transparent","currentItemEndArrowhead":"arrow","currentItemFillStyle":"hachure","currentItemFontFamily":1,"currentItemFontSize":20,"currentItemLinearStrokeSharpness":"round","currentItemOpacity":100,"currentItemRoughness":1,"currentItemStartArrowhead":null,"currentItemStrokeColor":"#000000","currentItemStrokeSharpness":"sharp","currentItemStrokeStyle":"solid","currentItemStrokeWidth":1,"currentItemTextAlign":"left","cursorButton":"up","editingGroupId":null,"elementLocked":false,"elementType":"selection","exportBackground":true,"exportScale":1,"exportEmbedScene":false,"exportWithDarkMode":false,"gridSize":null,"lastPointerDownWith":"mouse","name":"行为树导航器实现架构","openMenu":null,"previousSelectedElementIds":{"7z-xxbGT_aC3-5Vz6ovfM":true},"scrolledOutside":false,"scrollX":336.8611111111118,"scrollY":124.1111111111111,"selectedElementIds":{"1MZMD4NMm4qA7lFn3LvM8":true},"selectedGroupIds":{},"shouldCacheIgnoreZoom":false,"showStats":false,"viewBackgroundColor":"#ffffff","zenModeEnabled":false,"zoom":{"value":0.6}},"files":{}}